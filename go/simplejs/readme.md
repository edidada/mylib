# simplejs

A minimal JavaScript interpreter written in Go.

## 功能

- 支持算术运算符：+, -, *, /, %, ++, +=
- 支持比较运算：<, <=, >, >=, ==, !=, ===, !==
- 支持逻辑运算：&&, ||, !
- 支持位运算：&, |, ^, ~, <<, >>, >>>
- 变量声明：var, let, const，支持块级作用域
- delete 操作符：符合 JavaScript 语义的对象属性删除
- 字符串模板：反引号模板字符串（无插值）
- 正则字面量：/pattern/flags
- 函数声明、函数表达式及箭头函数
- 类与继承：class, extends, super()
- 对象和数组字面量、解构赋值
- 错误处理：try, catch, throw
- 注释支持：单行 (//) 与多行 (/* ... */)

## 测试

go test -v -failfast ./...

## 架构

```
graph LR
    A[JavaScript引擎实现方案] --> B[词法分析器]
    A --> C[语法分析器]
    A --> D[语义解析器]
    A --> E[语义优化]
    A --> F[虚拟机]
    A --> G[JIT编译器]

    %% 词法分析器部分
    B --> B1[功能: 将源代码分解为词法单元 tokens]
    B1 --> B2[实现步骤]
    B2 --> B21[扫描代码]
    B2 --> B22[识别代码]
    B2 --> B23[生成词法单元序列]
    B1 --> B3["示例: let x = 1+2; 分解为 let x = 1 + 2 ;"]

    %% 语法分析器部分
    C --> C1[功能: 根据语法规则构建抽象语法树 AST]
    C1 --> C2[实现步骤]
    C2 --> C21[读取词法单元序列]
    C2 --> C22[依据语法规则进行分析]
    C2 --> C23[构建语法树结构]
    C1 --> C3[示例: 根据语法规则将词法单元组织成有结构的语法树表示]

    %% 语义解析器部分
    D --> D1[功能: 检查代码语义并执行，进行类型检查]
    D1 --> D2[实现步骤]
    D2 --> D21[遍历语法树]
    D2 --> D22[检查变量声明和使用]
    D2 --> D23[执行各类型节点和操作]
    D1 --> D3[示例: 确保变量在使用前已声明，类型操作合法]

    %% 语义优化部分
    E --> E1[功能: 提高代码执行效率，减少资源消耗]
    E1 --> E2[实现步骤]
    E2 --> E21[分析执行路径]
    E2 --> E22[应用优化规则]
    E2 --> E23[生成优化后的代码]
    E1 --> E3[优化方式]
    E3 --> E31[常量折叠]
    E3 --> E32[死代码消除]
    E3 --> E33[内联函数]

    %% 虚拟机部分
    F --> F1[功能: 解释执行优化后的代码]
    F1 --> F2[实现架构]
    F2 --> F21[基于栈模型]
    F2 --> F22[基于寄存器模型]
    F1 --> F3[实现步骤]
    F3 --> F31[快速指令操作]
    F3 --> F32[管理执行状态]
    F3 --> F33[读取优化后的代码]

    %% JIT编译器部分
    G --> G1[功能: 动态将热点代码编译为机器码]
    G1 --> G2[实现步骤]
    G2 --> G21[监测执行频率]
    G2 --> G22[编译热点代码]
    G2 --> G23[执行优化后的机器码]
    G1 --> G3[编译类型]
    G3 --> G31[基线编译]
    G3 --> G32[优化编译]
```

